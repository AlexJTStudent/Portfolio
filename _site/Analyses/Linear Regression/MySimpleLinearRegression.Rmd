---
title: "Simple Linear Regression"
output: 
  html_document:
    theme: flatly
    code_folding: hide
---

```{r, message=FALSE, warning=FALSE}
# Load your libraries
library(pander)
library(car)
library(DT)
library(mosaic)
library(rio)
library(tidyverse)
library(readr)
library(ggthemes)

admissions <- read.csv("C:\\Users\\Alex\\Documents\\GitHub\\IntStats\\Statistics-Notebook-master\\Data\\adm_data.csv")
# Load your data after saving a csv file in your Data folder.
# You can use either 
#   someName <- read.csv("../Data/YourDataFileName.csv", header=TRUE)
# or
#   library(readr)
#   someName <- read_csv("../Data/YourDataFileName.csv")

# Don't forget to run "Session -> Set Working Directory -> To Source file location"

```

# Admission Chances

To perform this week's Linear Regression, I've decided to scroll through Kaggle's dataset page and found the "Data for Admission in the University". The dataset generalizes the changes of getting into a graduate university based on the student's application stats.

# Questions & Hypotheses

I wanted to answer a clear and intuitive question:

##### __Is there an correlation between undergrad GPA and chances of getting admitted into grad school?__

$$
H_0: \beta_1 = 0 \\  
H_a: \beta_1 \neq 0
$$

$$
\alpha = \text{0.05}
$$

If so, how much admissions depend on a the GPA of an Student? This analysis utilizes data from unverified authors from Kaggle, thus the study only aims to answer questions & Hypotheses and refrain from recommending inferences applied to the real world.

$$
  \underbrace{\hat{Y}_i}_\text{Ave. Chance of Admit} = \text{-1.07} + \text{0.209} \underbrace{X_i}_\text{Undergrad CGPA}
$$

The equation for every additional GPA point increases the Chance of Admission. In other words, every fifth of a GPA point will increase admission chance 21%, given that the minimum CGPA starts at 6.5.


```{r, fig.height=4, fig.width=7}


ggplot(admissions, aes(x = CGPA, y = Chance.of.Admit)) +
  geom_point() +
  scale_y_continuous(breaks = seq(0,1,0.1)) +
  scale_x_continuous(breaks = seq(6,10,0.5)) +
  geom_smooth(method = "lm", formula=y~x, se=FALSE) +
  labs(title = "There is an correlation between undergrad GPA and the chances of getting admitted into grad school",
       x = "CGPA",
       y = "Chance of Admission") +
  theme(plot.title = element_text(size = 10, hjust = 1))

```

# Analysis Details

$$
  \underbrace{\hat{Y}_i}_\text{Chance of Admit} = \overbrace{b_0}^\text{y-int} + \overbrace{b_1}^\text{slope} \underbrace{X_i}_\text{Undergraduate GPA}
$$

### Summary of the Regression

```{r}
cars.lm <- lm(Chance.of.Admit ~ admissions$CGPA, data=admissions)
pander(summary(cars.lm))
```

This shows that the slope is significant (p = 2.337e-126), Thus the relationship between admission chance and CGPA exists and is meaningful.

Assuming the model is appropiate, then we estimate that increasing the GPA by 1 point will result in an extra 0.2088 chance of getting admitted. With an model "Residual Standard of Error" of 0.06957, impliying that overall the model was off by 6.957% of admission chance


## Appropriateness of the above Regression

A check on the **appropriateness** of the model shows that the residuals vs fitted values aren't very align with one another, as well as a significant portion of data points in the qqPlot aren't normal. Therefore any results yield in the test have to be taken with a big grain of salt given that the data isn't very fitted or normally distributed.

```{r}
par(mfrow=c(1,3))
plot(cars.lm, which=1)
qqPlot(cars.lm$residuals, id=FALSE)
plot(cars.lm$residuals, main="Residuals vs Order")
```

## Interpretation

At the end, it does seem to appear that there is an correlation between undergrad CGPA and chances of getting admitted into grad school. At a p-value of p = 2.337e-126, it rejects our alpha of 0.05, rejecting the null and concluding with the alternative. Although, the conclusion has to be taken with the warning that the data of the analysis isn't very appropriate, and the source of the data isn't very reputable or trustworthy to make conclusion regarding admission chance and CGPA relationships.

## Credit/References

Mild use of AI was used to customize the plots of the Analysis. Guidance and inspiration to perform the analysis is credited to the "bodyweight" analysis in the "Statistic Notebook" provided by the course.

[Kaggle Dataset](https://www.kaggle.com/datasets/akshaydattatraykhare/data-for-admission-in-the-university)



```{=html}
<!-- Directions

Come up with a simple linear regression of your own creation. 

* Write the Background and clearly state your question. Then collect data and perform the linear regression analysis in order to answer your question. Use the proper order of first, ask the question, then second, figure out the answer.

* You should collect both the quantitative response variable and the quantitative explanatory variable yourself. This can be data you collect from 
    - the internet (like weather data, Facebook data, or sports data) 
    - your own experiment 
    - your own observational study
* However,     
    - The data should not be a single pre-existing dataset. It must be something that you piece together yourself.

* You need at least $n=3$ $(X,Y)$ pairs to perform the regression. However, your regression will only be useful if you can get around $n=10$ or more observations.

-->
```
